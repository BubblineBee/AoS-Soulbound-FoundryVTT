<div class="age-of-sigmar-soulbound chat roll">
    {{log this}}
    <div class="content-box">
        <div class="content-header">
            <h2>DN {{testData.dn.difficulty}}:{{testData.dn.complexity}} {{testData.dn.name}} Test</h2>
        </div>
        <div class="diceContainer">
            {{#each result.dice as |dice index|}}
            {{#if ../context.focusAllocated}}
            <div class="die">
                <img class="diceImg" src="{{dice.img}}">
                {{#if dice.focus}}
                <div class="focus-counter">
                    {{dice.focus}}
                </div>
                {{/if}}
            </div>
            {{else}}
            <a class="die diceClick" data-index={{index}}>
                <img class="diceImg" src="{{dice.img}}">
                <div class="focus-counter" style="display:none">
                    0
                </div>
            </a>
            {{/if}}
            {{/each}}
        </div>
        <div class="content-rowElement">
            {{#if result.success}}
            <h4 style="color: var(--color-succeed)"><strong>{{localize "CHAT.SUCCESS" degree=result.degree}}</strong></h4>
            {{else}}
            <h4 style="color: var(--color-deadly)">{{localize "CHAT.FAILED" degree=result.degree}}</h4>
            {{/if}}
        </div>
        <div class="content-wrapper">
            {{#if context.focusAllocated}}
            <p style="margin-top: 5px"><strong>{{localize "CHAT.FOCUS"}} :</strong> {{result.focus}} {{localize "CHAT.FOCUS_APPLIED"}}</p>
            {{else if result.focus}}
            <p style="margin-top: 5px"><strong>{{localize "CHAT.FOCUS"}} :</strong> {{localize "CHAT.FOCUS_AVAILABLE" focus=result.focus}}</p>
            {{/if}}

            {{#if result.damage}}
            <p style="margin-top: 5px"><strong>{{localize "CHAT.DAMAGE"}} :</strong> {{result.damage.total}}</p>
            {{/if}}

            {{#if result.traits}}
            <p style="margin-top: 5px"><strong>{{localize "CHAT.TRAITS"}} :</strong> {{result.traits}}</p>
            {{/if}}

            {{#if result.duration}}
            <p style="margin-top: 5px"><strong>{{localize "CHAT.DURATION"}} :</strong> {{result.duration.value}} {{result.duration.unit}} </p>
            {{/if}}

            {{#if result.overcast}}
            <p style="margin-top: 5px"><strong>{{localize "CHAT.OVERCAST"}} :</strong> {{result.overcast}}</p>
            {{/if}}
        </div>
        {{#if result.damage.traitEffects.length}}
        <div class="content-wrapper">
            <p style="margin-top: 5px"><strong>{{localize "CHAT.TRAIT_EFFECTS"}} :</strong></p>
            <ul>
                {{#each result.damage.traitEffects as |effect|}}
                {{#if effect.isRend}}
                <li><span class="rend-value">{{effect.text}}</span></li>
                {{/if}}
                {{#if effect.isCleave}}
                <li><span class="cleave-value">{{effect.text}}</span></li>
                {{/if}}
                {{#if effect.isPlain}}
                <li>{{effect.text}}</li>
                {{/if}}

                {{/each}}
            </ul>
        </div>
        {{/if}}
        {{#if hasTest}}
        <div class="content-wrapper test-buttons">
            <button class="test-button" type="button">{{ItemTestDisplay}}</button>
        </div>
        {{/if}}
        {{#if spellFailed}}
        <div class="content-wrapper test-buttons">
            <button class="spell-fail-button" type="button">The Price of Failure</button>
        </div>
        {{/if }}
        {{#if effects.length}}
        <div class="content-wrapper test-buttons">
        {{#each effects as |effect e|}}
            <button class="effect-button" title="Apply the effect to selected tokens or your assigned character" data-id="{{effect.id}}" type="button"><img src="{{effect.data.icon}}" width="25" height="25"> Apply {{effect.label}}</button>
        {{/each}}
        </div>
        {{/if}}
    </div>
</div>